var DiffMatch=function(){function t(){this.text1="",this.text2="",this.dp=[],this.path=[]}var e=0,i=-1,h=1,s="↖︎",r="↑",n="←";return t.prototype.diff=function(t,e,i){var h=(new Date).getTime();i&&(t=t.split("\n"),e=e.split("\n"),t.forEach(function(e,i){t[i]=e+"\n"}),e.forEach(function(t,i){e[i]=t+"\n"}));var p=t.length,a=e.length;this.init(t,e);for(var f=1,o=0,u=1;u<=p;++u,o=f,f=Number(!f))for(var l=1;l<=a;++l)t[u-1]===e[l-1]?(this.dp[f][l]=this.dp[o][l-1]+1,this.path[u][l]=s):this.dp[o][l]>this.dp[f][l-1]?(this.dp[f][l]=this.dp[o][l],this.path[u][l]=r):(this.dp[f][l]=this.dp[f][l-1],this.path[u][l]=n);this.diffs=this.getDiffsFromPath();var g=(new Date).getTime();return this.timeConsumed=g-h,this.diffs},t.prototype.init=function(t,e){this.text1=t,this.text2=e;var i=t.length,h=e.length;this.dp=[];for(var s=0;s<2;++s){this.dp.push([]);for(var r=0;r<=h;++r)this.dp[s].push(0)}this.path=[];for(var s=0;s<=i;++s){this.path.push([]);for(var r=0;r<=h;++r)this.path[s].push(0)}},t.prototype.getLCS=function(){function t(p,a){0!==p&&0!==a&&(i[p][a]===s?(t(p-1,a-1),e+=h[p-1]):i[p][a]===r?t(p-1,a):i[p][a]===n&&t(p,a-1))}var e="",i=this.path,h=this.text1;return t(this.text1.length,this.text2.length),e},t.prototype.getDiffsFromPath=function(){function t(u,l){return 0===u||0===l?(0!==u&&("string"==typeof f?p.push([i,f.substring(0,u)]):p.push([i,f.splice(0,u).join("")])),void(0!==l&&("string"==typeof o?p.push([h,o.substring(0,l)]):p.push([h,o.splice(0,l).join("")])))):void(a[u][l]===s?(t(u-1,l-1),p.push([e,f[u-1]])):a[u][l]===r?(t(u-1,l),p.push([i,f[u-1]])):a[u][l]===n&&(t(u,l-1),p.push([h,o[l-1]])))}var p=[],a=this.path,f=this.text1,o=this.text2;return t(f.length,o.length),this.mergeDiffs(p)},t.prototype.mergeDiffs=function(t){if(!t||!t.length)return[];for(var e=[],i=t[0][0],h=t[0][1],s=1;s<t.length;++s){for(;s<t.length&&t[s][0]===i;)h+=t[s++][1];if(e.push([i,h]),h="",s>=t.length)break;i=t[s][0],h=t[s][1]}return h&&e.push([i,h]),e},t.prototype.prettyHtml=function(){for(var t=this.diffs,s=[],r=/&/g,n=/</g,p=/>/g,a=/\n/g,f=/ /g,o=/\t/g,u=0;u<t.length;u++){var l=t[u][0],g=t[u][1],c=g.replace(r,"&amp;").replace(n,"&lt;").replace(p,"&gt;").replace(a,"&para;<br>").replace(f,"&nbsp;").replace(o,"&nbsp;&nbsp;");switch(l){case h:s[u]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case i:s[u]='<del style="background:#ffe6e6;">'+c+"</del>";break;case e:s[u]="<span>"+c+"</span>"}}return s.join("")},t.prototype.pathHtml=function(t){function e(t,h){0!==t&&0!==h&&(a.push(t+"_"+h),i[t][h]===s?e(t-1,h-1):i[t][h]===r?e(t-1,h):i[t][h]===n&&e(t,h-1))}var i=this.path,h=this.text1.length,p=this.text2.length,a=[];if(t){var f=this.text1;e(this.text1.length,this.text2.length)}for(var f="<table><tr><td>&nbsp;</td>",o=0;o<p;++o)f+="<td>"+("\n"!==this.text2[o]?this.text2[o]:"\\n")+"</td>";f+="</tr>";for(var o=1;o<=h;++o){f+="<tr><td>"+("\n"!==this.text1[o-1]?this.text1[o-1]:"\\n")+"</td>";for(var u=1;u<=p;++u)f+="<td"+(t&&a.indexOf(o+"_"+u)!==-1?' style="color: red;"':"")+">"+i[o][u]+"</td>";f+="</tr>"}return f+="</table>"},t}();window.DiffMatch=DiffMatch;